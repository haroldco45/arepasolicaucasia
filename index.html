<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedidos - Arepas Campesinas Oli</title>
    <style>
        :root {
            --primary: #004a99;
            --secondary: #25d366;
            --light: #f4f7f6;
            --accent: #fbc02d;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--light); margin: 0; padding: 15px; }
        .container { max-width: 650px; background: white; margin: auto; padding: 25px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        
        /* Encabezado con Logo del Repositorio */
        .header { text-align: center; border-bottom: 3px solid var(--primary); padding-bottom: 15px; margin-bottom: 20px; position: relative; }
        .logo-principal { width: 120px; height: auto; margin-bottom: 10px; }
        
        h2 { color: var(--primary); margin: 5px 0; letter-spacing: 1px; }
        .info-contacto { font-size: 0.9em; color: #555; margin-bottom: 10px; }

        /* Estilos de Formulario */
        h3 { border-left: 5px solid var(--accent); padding-left: 10px; color: #333; font-size: 1.1em; margin-top: 25px; }
        .form-group { margin-bottom: 12px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.85em; color: #444; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 1em; }
        
        /* Tabla de Productos */
        .product-list { margin-top: 15px; }
        .product-header { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 10px; font-weight: bold; background: var(--primary); color: white; padding: 10px; border-radius: 8px 8px 0 0; font-size: 0.8em; text-align: center; }
        .product-row { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 10px; align-items: center; padding: 12px 5px; border-bottom: 1px solid #eee; text-align: center; }
        .product-name { text-align: left; font-weight: 600; font-size: 0.9em; }
        .qty-input { text-align: center; padding: 8px; border: 2px solid var(--primary); font-weight: bold; color: var(--primary); }

        /* Totales y Bot√≥n */
        .total-box { background: #fdf2d0; padding: 20px; border-radius: 10px; margin-top: 25px; text-align: right; border: 1px solid var(--accent); }
        .grand-total { font-size: 1.4em; color: #d32f2f; }
        .btn-whatsapp { background: var(--secondary); color: white; border: none; padding: 18px; width: 100%; border-radius: 10px; font-size: 1.2em; cursor: pointer; font-weight: bold; margin-top: 20px; display: flex; align-items: center; justify-content: center; gap: 10px; transition: 0.3s; }
        .btn-whatsapp:hover { background: #1eb954; transform: scale(1.02); }

        /* Suscripci√≥n y Footer */
        #exp-notice { display: none; background: #ffebee; color: #c62828; padding: 20px; border-radius: 10px; text-align: center; font-weight: bold; border: 2px solid #c62828; }
        .footer { text-align: center; font-size: 0.75em; color: #888; margin-top: 30px; line-height: 1.6; }
        .vibras-tag { color: var(--primary); font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <img src="arepas-campesinas-oli.png" alt="Logo Oli" class="logo-principal">
        <h2>AREPAS CAMPESINAS OLI</h2>
        <div class="info-contacto">üìç Caucasia, Antioquia | üì± 3135370683</div>
        <div style="background: #eee; display: inline-block; padding: 5px 15px; border-radius: 20px; font-size: 0.85em;">
            <strong>Pedido N¬∞:</strong> <span id="num-pedido">---</span>
        </div>
    </div>

    <div id="exp-notice">‚ö†Ô∏è La suscripci√≥n de esta App ha vencido. <br> Contacte al desarrollador (Vibras Positivas).</div>

    <form id="orderForm">
        <h3>Datos del Cliente</h3>
        <div class="form-group">
            <label>Nombre del Cliente / Propietario</label>
            <input type="text" id="cliente" placeholder="Nombre completo" required>
        </div>
        <div class="form-group">
            <label>Nombre de la Tienda / Negocio</label>
            <input type="text" id="tienda" placeholder="Ej: Supermercado El √âxito" required>
        </div>
        <div class="form-group">
            <label>Direcci√≥n de Entrega</label>
            <input type="text" id="direccion" placeholder="Calle, Carrera, Barrio" required>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <div class="form-group">
                <label>Celular</label>
                <input type="tel" id="celular" placeholder="310..." required>
            </div>
            <div class="form-group">
                <label>Forma de Pago</label>
                <select id="pago">
                    <option value="Efectivo">Efectivo</option>
                    <option value="Nequi">Nequi</option>
                    <option value="Transferencia">Transferencia</option>
                </select>
            </div>
        </div>

        <h3>Selecci√≥n de Productos</h3>
        <div class="product-list">
            <div class="product-header">
                <div>Descripci√≥n</div>
                <div>Unidad</div>
                <div>Cant.</div>
                <div>Subtotal</div>
            </div>
            
            <div class="product-row">
                <div class="product-name">Arepa de Ma√≠z (Tela)</div>
                <div style="font-size: 0.8em; color: #666;">Paquete</div>
                <input type="number" class="qty-input qty" data-name="Arepa de Ma√≠z" data-price="5000" value="0" min="0" oninput="calculate()">
                <div class="subtotal">$0</div>
            </div>

            <div class="product-row">
                <div class="product-name">Arepa con Queso</div>
                <div style="font-size: 0.8em; color: #666;">Unidad</div>
                <input type="number" class="qty-input qty" data-name="Arepa con Queso" data-price="2500" value="0" min="0" oninput="calculate()">
                <div class="subtotal">$0</div>
            </div>
        </div>

        <div class="form-group" style="margin-top: 15px;">
            <label>Observaciones del Pedido</label>
            <textarea id="obs" rows="2" placeholder="Ej: Dejar en porter√≠a, traer cambio de 50mil..."></textarea>
        </div>

        <div class="total-box">
            <span style="font-weight: bold; color: #555;">TOTAL DEL PEDIDO:</span><br>
            <strong class="grand-total">$ <span id="total-val">0</span></strong>
        </div>

        <button type="button" class="btn-whatsapp" onclick="enviarPedido()">
            üöÄ ENVIAR PEDIDO POR WHATSAPP
        </button>
    </form>

    <div class="footer">
        App desarrollada por <span class="vibras-tag">Vibras Positivas</span><br>
        ¬© Derechos de Autor Reservados<br>
        <span id="fecha-colombia"></span>
    </div>
</div>

<script>
    // --- CONTROL DE SUBSCRIPCI√ìN ---
    const FECHA_EXP = new Date('2027-02-12'); // Fecha de vencimiento
    const hoy = new Date();
    if (hoy > FECHA_EXP) {
        document.getElementById('orderForm').style.display = 'none';
        document.getElementById('exp-notice').style.display = 'block';
    }

    // --- N√öMERO DE PEDIDO Y FECHA ---
    const pedidoID = "OLI-" + Math.floor(1000 + Math.random() * 9000);
    document.getElementById('num-pedido').innerText = pedidoID;

    const options = { timeZone: 'America/Bogota', year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' };
    document.getElementById('fecha-colombia').innerText = "Colombia: " + hoy.toLocaleDateString('es-CO', options);

    // --- L√ìGICA DE C√ÅLCULO ---
    function calculate() {
        let total = 0;
        const rows = document.querySelectorAll('.product-row');
        rows.forEach(row => {
            const input = row.querySelector('.qty');
            const price = parseInt(input.getAttribute('data-price'));
            const qty = parseInt(input.value) || 0;
            const sub = price * qty;
            row.querySelector('.subtotal').innerText = "$" + sub.toLocaleString();
            total += sub;
        });
        document.getElementById('total-val').innerText = total.toLocaleString();
    }

    // --- ENV√çO A WHATSAPP ---
    function enviarPedido() {
        const cliente = document.getElementById('cliente').value;
        const tienda = document.getElementById('tienda').value;
        const direccion = document.getElementById('direccion').value;
        const cel = document.getElementById('celular').value;
        const pago = document.getElementById('pago').value;
        const total = document.getElementById('total-val').innerText;
        const obs = document.getElementById('obs').value || "Ninguna";

        if(!cliente || !tienda || !direccion) {
            alert("Por favor, completa los datos del cliente.");
            return;
        }

        let mensaje = `*PEDIDO NUEVO: ${pedidoID}*\n`;
        mensaje += `--------------------------\n`;
        mensaje += `üë§ *Cliente:* ${cliente}\n`;
        mensaje += `üè™ *Tienda:* ${tienda}\n`;
        mensaje += `üìç *Direcci√≥n:* ${direccion}\n`;
        mensaje += `üìû *Celular:* ${cel}\n`;
        mensaje += `üí≥ *Pago:* ${pago}\n`;
        mensaje += `--------------------------\n`;
        mensaje += `*PRODUCTOS:*\n`;

        const inputs = document.querySelectorAll('.qty');
        let hayProductos = false;
        inputs.forEach(input => {
            if(parseInt(input.value) > 0) {
                mensaje += `‚úÖ ${input.value} x ${input.getAttribute('data-name')}\n`;
                hayProductos = true;
            }
        });

        if(!hayProductos) {
            alert("No has seleccionado ning√∫n producto.");
            return;
        }

        mensaje += `--------------------------\n`;
        mensaje += `üìù *Obs:* ${obs}\n`;
        mensaje += `üí∞ *TOTAL A COBRAR: $${total}*\n\n`;
        mensaje += `_Generado por Vibras Positivas_`;

        const url = `https://wa.me/573135370683?text=${encodeURIComponent(mensaje)}`;
        window.open(url, '_blank');
    }
</script>

</body>
</html>
