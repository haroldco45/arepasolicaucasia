<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedidos - Arepas Campesinas Oli</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root {
            --primary: #004a99;
            --secondary: #25d366;
            --light: #f4f7f6;
            --accent: #fbc02d;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--light); margin: 0; padding: 15px; }
        .container { max-width: 650px; background: white; margin: auto; padding: 25px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        
        /* Encabezado */
        .header { text-align: center; border-bottom: 3px solid var(--primary); padding-bottom: 15px; margin-bottom: 20px; }
        .logo-principal { width: 130px; height: auto; margin-bottom: 10px; border-radius: 50%; }
        
        h2 { color: var(--primary); margin: 5px 0; letter-spacing: 1px; }
        .info-contacto { font-size: 0.9em; color: #555; margin-bottom: 10px; }

        /* QR Section */
        .qr-container { background: #fff; padding: 15px; display: flex; flex-direction: column; align-items: center; border: 1px dashed #ccc; margin-bottom: 20px; border-radius: 10px; }
        #qrcode { margin-bottom: 10px; }
        .qr-text { font-size: 0.7em; color: #666; font-weight: bold; }

        /* Estilos de Formulario */
        h3 { border-left: 5px solid var(--accent); padding-left: 10px; color: #333; font-size: 1.1em; margin-top: 25px; }
        .form-group { margin-bottom: 12px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.85em; color: #444; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 1em; }
        
        /* Tabla de Productos */
        .product-list { margin-top: 15px; }
        .product-header { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 10px; font-weight: bold; background: var(--primary); color: white; padding: 10px; border-radius: 8px 8px 0 0; font-size: 0.75em; text-align: center; }
        .product-row { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 10px; align-items: center; padding: 12px 5px; border-bottom: 1px solid #eee; text-align: center; }
        .product-name { text-align: left; font-weight: 600; font-size: 0.9em; }
        .qty-input { text-align: center; padding: 8px; border: 2px solid var(--primary); font-weight: bold; border-radius: 5px; }

        /* Totales y Bot√≥n */
        .total-box { background: #fdf2d0; padding: 20px; border-radius: 10px; margin-top: 25px; text-align: right; border: 1px solid var(--accent); }
        .grand-total { font-size: 1.4em; color: #d32f2f; }
        .btn-whatsapp { background: var(--secondary); color: white; border: none; padding: 18px; width: 100%; border-radius: 10px; font-size: 1.2em; cursor: pointer; font-weight: bold; margin-top: 20px; transition: 0.3s; }
        .btn-whatsapp:hover { background: #1eb954; transform: scale(1.01); }

        /* Suscripci√≥n y Footer */
        #exp-notice { display: none; background: #ffebee; color: #c62828; padding: 25px; border-radius: 10px; text-align: center; font-weight: bold; border: 2px solid #c62828; }
        .footer { text-align: center; font-size: 0.8em; color: #777; margin-top: 30px; border-top: 1px solid #eee; padding-top: 15px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <img src="arepas-campesinas-oli.png" alt="Logo Arepas Oli" class="logo-principal">
        <h2>AREPAS CAMPESINAS OLI</h2>
        <div class="info-contacto">üìç Caucasia, Antioquia | üì± 3135370683</div>
    </div>

    <div class="qr-container">
        <div id="qrcode"></div>
        <div class="qr-text">ESCANEA PARA PEDIR DESDE TU CELULAR</div>
    </div>

    <div style="text-align: center; background: #f0f0f0; padding: 5px 15px; border-radius: 20px; font-size: 0.85em; font-weight: bold; margin-bottom: 20px;">
        Pedido N¬∞: <span id="num-pedido">---</span>
    </div>

    <div id="exp-notice">
        ‚ö†Ô∏è ATENCI√ìN: La suscripci√≥n de esta aplicaci√≥n ha caducado.<br>
        Por favor, contacte al desarrollador (Vibras Positivas).
    </div>

    <form id="orderForm">
        <h3>Datos del Cliente</h3>
        <div class="form-group">
            <label>Nombre del Cliente</label>
            <input type="text" id="cliente" required placeholder="Nombre de quien recibe">
        </div>
        <div class="form-group">
            <label>Nombre de la Tienda / Negocio</label>
            <input type="text" id="tienda" required placeholder="Nombre del establecimiento">
        </div>
        <div class="form-group">
            <label>Direcci√≥n</label>
            <input type="text" id="direccion" required placeholder="Calle, carrera y barrio">
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <div class="form-group">
                <label>Celular</label>
                <input type="tel" id="celular" required placeholder="N√∫mero de contacto">
            </div>
            <div class="form-group">
                <label>Forma de Pago</label>
                <select id="pago">
                    <option value="Efectivo">Efectivo</option>
                    <option value="Nequi">Nequi</option>
                    <option value="Transferencia">Transferencia</option>
                </select>
            </div>
        </div>

        <h3>Productos</h3>
        <div class="product-list">
            <div class="product-header">
                <div>Producto</div>
                <div>Unidad</div>
                <div>Cantidad</div>
                <div>Subtotal</div>
            </div>
            
            <div class="product-row">
                <div class="product-name">Arepa de Ma√≠z (Blanca)</div>
                <div style="font-size: 0.8em; color: #666;">Paquete</div>
                <input type="number" class="qty-input qty" data-name="Arepa de Ma√≠z Blanca" data-price="5000" value="0" min="0" oninput="calculate()">
                <div class="subtotal">$0</div>
            </div>

            <div class="product-row">
                <div class="product-name">Arepa con Queso</div>
                <div style="font-size: 0.8em; color: #666;">Paquete</div>
                <input type="number" class="qty-input qty" data-name="Arepa con Queso" data-price="7500" value="0" min="0" oninput="calculate()">
                <div class="subtotal">$0</div>
            </div>
        </div>

        <div class="form-group" style="margin-top: 15px;">
            <label>Observaciones</label>
            <textarea id="obs" rows="2" placeholder="Notas adicionales..."></textarea>
        </div>

        <div class="total-box">
            <span style="font-weight: bold; color: #555;">VALOR TOTAL:</span><br>
            <strong class="grand-total">$ <span id="total-val">0</span></strong>
        </div>

        <button type="button" class="btn-whatsapp" onclick="enviarPedido()">
            ‚úÖ ENVIAR PEDIDO POR WHATSAPP
        </button>
    </form>

    <div class="footer">
        App desarrollada por <strong>Vibras Positivas</strong><br>
        Derechos de Autor Reservados ¬© 2026<br>
        <span id="fecha-colombia"></span>
    </div>
</div>

<script>
    // --- GENERAR C√ìDIGO QR AUTOM√ÅTICO ---
    // Detecta la URL actual para que el QR siempre funcione
    var qrcode = new QRCode(document.getElementById("qrcode"), {
        text: window.location.href,
        width: 128,
        height: 128,
        colorDark : "#004a99",
        colorLight : "#ffffff",
        correctLevel : QRCode.CorrectLevel.H
    });

    // --- CONTROL DE SUBSCRIPCI√ìN ---
    const FECHA_VENCE = new Date('2027-02-12'); 
    const fechaHoy = new Date();

    if (fechaHoy > FECHA_VENCE) {
        document.getElementById('orderForm').style.display = 'none';
        document.getElementById('exp-notice').style.display = 'block';
    }

    // --- N√öMERO DE PEDIDO ---
    const idPedido = "OLI-" + Math.floor(1000 + Math.random() * 9000);
    document.getElementById('num-pedido').innerText = idPedido;

    // --- HORA COLOMBIA ---
    const localTime = new Date().toLocaleString("es-CO", {timeZone: "America/Bogota", hour12: true});
    document.getElementById('fecha-colombia').innerText = "Fecha/Hora: " + localTime;

    function calculate() {
        let total = 0;
        const rows = document.querySelectorAll('.product-row');
        rows.forEach(row => {
            const input = row.querySelector('.qty');
            const price = parseInt(input.getAttribute('data-price'));
            const qty = parseInt(input.value) || 0;
            const sub = price * qty;
            row.querySelector('.subtotal').innerText = "$" + sub.toLocaleString();
            total += sub;
        });
        document.getElementById('total-val').innerText = total.toLocaleString();
    }

    function enviarPedido() {
        const cliente = document.getElementById('cliente').value;
        const tienda = document.getElementById('tienda').value;
        const direccion = document.getElementById('direccion').value;
        const cel = document.getElementById('celular').value;
        const pago = document.getElementById('pago').value;
        const totalF = document.getElementById('total-val').innerText;
        const obs = document.getElementById('obs').value || "Ninguna";

        if(!cliente || !tienda || !direccion || !cel) {
            alert("Por favor completa los datos del cliente");
            return;
        }

        let mensaje = `*PEDIDO NUEVO: ${idPedido}*\n`;
        mensaje += `--------------------------\n`;
        mensaje += `üë§ *Cliente:* ${cliente}\n`;
        mensaje += `üè™ *Tienda:* ${tienda}\n`;
        mensaje += `üìç *Direcci√≥n:* ${direccion}\n`;
        mensaje += `üìû *Celular:* ${cel}\n`;
        mensaje += `--------------------------\n`;
        mensaje += `*DETALLE DEL PEDIDO:*\n\n`;

        const inputs = document.querySelectorAll('.qty');
        let checkItems = false;

        inputs.forEach(input => {
            const c = parseInt(input.value);
            if(c > 0) {
                const n = input.getAttribute('data-name');
                const p = parseInt(input.getAttribute('data-price'));
                const s = p * c;
                mensaje += `üî∏ *${n}*\n`;
                mensaje += `   ${c} und. x $${p.toLocaleString()} = *$${s.toLocaleString()}*\n\n`;
                checkItems = true;
            }
        });

        if(!checkItems) {
            alert("Debes agregar al menos un producto");
            return;
        }

        mensaje += `--------------------------\n`;
        mensaje += `üìù *Obs:* ${obs}\n`;
        mensaje += `üí≥ *Pago:* ${pago}\n`;
        mensaje += `üí∞ *TOTAL A PAGAR: $${totalF}*\n\n`;
        mensaje += `_App desarrollada por Vibras Positivas_`;

        const link = `https://wa.me/573135370683?text=${encodeURIComponent(mensaje)}`;
        window.open(link, '_blank');
    }
</script>

</body>
</html>
